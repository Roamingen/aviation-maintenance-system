# ✈️ 民航检修存证系统 - 答辩与技术要点指南

本文档旨在为项目答辩提供核心技术支持、架构解析及演示流程指导，帮助团队成员快速掌握项目精髓，从容应对答辩提问。

---

## 1. 项目背景与痛点 (Why Blockchain?)

在答辩开场时，首先明确**为什么**我们要用区块链做这个系统。

*   **传统痛点**：
    *   **数据易篡改**：纸质记录或中心化数据库（如 MySQL）容易被管理员或黑客修改，事故发生后难以追责。
    *   **信息孤岛**：航空公司、维修厂、监管机构（民航局）之间数据不互通，信任成本高。
    *   **追溯困难**：维修历史分散，难以快速构建完整的飞机全生命周期档案。
*   **我们的解决方案**：
    *   利用区块链的**不可篡改性**，确保每一条维修记录、每一个签名都是真实可信的。
    *   利用**智能合约**自动执行逻辑（如：必须先互检才能放行），杜绝人为违规操作。

---

## 2. 核心技术架构 (Architecture)

### 2.1 整体架构图 (口述/PPT展示)
> "我们采用了经典的 DApp (去中心化应用) 混合架构。"

1.  **区块链层 (Layer 1)**:
    *   **网络**: Hardhat Local Network (模拟企业级联盟链)。
    *   **智能合约**: Solidity 编写，负责核心业务逻辑（存储记录、权限控制、状态流转）。
2.  **后端层 (Layer 2)**:
    *   **Node.js + Express**: 作为 API 网关。
    *   **作用**: 封装复杂的链上交互，为前端提供标准的 RESTful API；管理“管理员钱包”进行自动上链。
3.  **前端层 (Layer 3)**:
    *   **Vue 3 + Element Plus**: 提供友好的用户界面。
    *   **Web3 交互**: 集成 `ethers.js` 和 MetaMask，实现用户端的数字签名。

### 2.2 关键技术点 (Technical Highlights)

*   **去中心化身份与权限 (RBAC)**:
    *   **白名单机制**: 合约中维护 `authorizedNodes` 列表。只有授权的钱包地址（如持证机械师）才能写入数据。
    *   **修饰符 (Modifiers)**: 使用 `onlyAuthorized` 修饰符，在代码层面强制拦截非法访问。
*   **数据完整性保障**:
    *   **Hash ID**: 每条记录上链时，系统自动生成唯一的 Hash 值作为“工作单号”。
    *   **数字签名**: 互检、RII、放行等关键环节，必须由对应人员使用私钥签名，签名信息永久记录在链上。
*   **零 Gas 费设计 (Zero Gas)**:
    *   针对企业内部使用场景，我们将网络配置为 `gasPrice: 0`。
    *   **优势**: 员工操作时无需购买 ETH 代币，极大降低了使用门槛和企业成本。

---

## 3. 关键文件解析 (Code Walkthrough)

如果评委要求看代码，请展示以下核心文件：

| 文件路径 | 作用 | 关键点 |
| :--- | :--- | :--- |
| `contracts/AviationMaintenance.sol` | **智能合约核心** | `struct MaintenanceRecord` (数据结构), `addRecord` (上链), `signRelease` (放行逻辑) |
| `backend/index.js` | **后端 API** | `/api/record` 接口，展示如何调用 `contract.addRecord` 将数据写入区块链。 |
| `frontend/src/components/SignAction.vue` | **前端签名组件** | 展示如何唤起 MetaMask，调用 `contract.signRelease` 进行数字签名。 |
| `frontend/src/components/Login.vue` | **登录鉴权** | 展示如何区分“授权用户”和“访客”，以及如何检查钱包地址权限。 |

---

## 4. 演示流程脚本 (Demo Script)

建议两名队员配合：一人操作电脑，一人讲解。

**场景 1：访客视角 (数据透明性)**
1.  点击“访客登录”。
2.  **讲解**: "普通用户或监管机构无需账号即可查询所有维修记录，保证了数据的公开透明。"
3.  尝试点击“录入信息”或“账户管理”。
4.  **讲解**: "但访客只有只读权限，无法修改任何数据，保证了安全性。"

**场景 2：机械师录入 (数据上链)**
1.  切换到“授权用户登录”，连接钱包（使用 Account #0 或已授权账号）。
2.  进入“录入信息”，填写一张工单（如：更换轮胎）。
3.  点击提交。
4.  **讲解**: "此时，后端正在调用智能合约，将这条记录永久写入区块链。系统自动生成了一个唯一的 Hash ID。"

**场景 3：放行签名 (权限与交互)**
1.  进入“查询信息”，找到刚才录入的记录，点击“查看详情”。
2.  滚动到底部“签名区域”。
3.  点击“签署放行”。
4.  **MetaMask 弹出** -> 点击确认。
5.  **讲解**: "这里我们唤起了 MetaMask 钱包。这一步是关键的数字签名过程，代表我对这条维修记录负责。签名成功后，记录状态变为 'Released'，且不可再更改。"

**场景 4：账户管理 (动态授权)**
1.  进入“账户管理”。
2.  展示“已授权节点列表”。
3.  **讲解**: "管理员可以动态添加或移除授权节点。比如新员工入职，我们在这里授权他的钱包地址；离职后，直接撤销授权，他将立即失去操作权限。"

---

## 5. 常见答辩问题 (Q&A)

**Q1: 为什么要用区块链？用数据库不行吗？**
*   **A**: 数据库的管理员权限太大了，可以随意修改历史数据（比如出了事故偷偷改维修记录）。区块链的特性是**一旦写入，无法篡改**。我们用区块链不是为了存数据，而是为了**存证据**（存证），确保责任可追溯。

**Q2: 数据存在哪里？图片/视频怎么存？**
*   **A**: 目前我们将文本数据（注册号、描述等）直接存在链上。对于大文件（图片/PDF），通常的做法是存去中心化存储（如 IPFS），然后把**文件的 Hash** 存在链上。本项目主要演示核心逻辑，暂未集成 IPFS。

**Q3: 如果私钥丢了怎么办？**
*   **A**: 在企业级应用中，通常会使用**多重签名钱包**或**密钥管理服务 (KMS)** 来管理私钥，而不是让员工自己保管助记词。本项目为了演示方便，使用了 MetaMask 个人钱包。

**Q4: 系统性能如何？**
*   **A**: 我们采用了**分页查询** (`getRecordIdsByPage`)，避免一次性加载所有数据。对于海量数据查询，未来可以引入 **The Graph** 这样的索引协议，或者在后端建立一个同步数据库用于快速检索，链上数据仅用于校验。

---

## 6. 团队分工 (建议)

*   **队员 A (项目经理/主讲)**: 负责开场介绍、项目背景、痛点分析以及整体架构的宏观讲解。掌控答辩节奏，回答业务价值类问题。
*   **队员 B (技术负责人)**: 负责讲解智能合约设计、权限控制逻辑、后端 API 实现及数据上链流程。回答技术底层、安全性及区块链原理相关问题。
*   **队员 C (产品演示)**: 负责系统实操演示（访客/录入/签名/授权全流程），展示前端交互细节。配合回答用户体验及操作流程相关问题。

祝答辩顺利！🚀
