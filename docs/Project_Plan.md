# 基于区块链的民航客机检修记录存证系统 - 项目企划书

## 1. 项目背景与目标
民航客机检修记录是保障飞行安全的关键数据。传统的纸质或中心化数据库存储方式存在数据易丢失、易篡改、难以追责等问题。本项目旨在利用区块链技术（去中心化、不可篡改、可追溯）构建一个民航客机检修记录存证系统，确保检修数据的真实性和完整性，实现跨基地、跨航司的数据共享与追责。

**项目性质**：大三区块链课程大作业（模拟环境，不实际上线）。
**部署环境**：本地单机运行（Hardhat 本地网络），模拟多节点环境。

## 2. 系统角色
系统设计两种主要角色：

1.  **普通用户（访客/监管者）**
    *   **权限**：只读。
    *   **功能**：
        *   根据**飞机注册号**查询该飞机的所有历史检修记录。
        *   根据**工卡号（唯一标识）**查询单次检修的详细信息（包含所有技术细节）。
        *   用于事故调查、例行检查或追责。

2.  **节点用户（机械师/基地维修站）**
    *   **权限**：读写。
    *   **功能**：
        *   向链上录入新的检修记录。
        *   对录入的数据进行数字签名（通过钱包交互），确保数据来源可信。
        *   模拟不同地区的维修基地（如北京基地、广州基地），每个基地拥有独立的写入权限。

## 3. 技术架构
本项目采用标准的 DApp 开发技术栈：

*   **区块链层**：
    *   **平台**：Ethereum (EVM 兼容)。
    *   **开发框架**：Hardhat (用于编译、部署、测试和本地节点运行)。
    *   **语言**：Solidity (编写智能合约)。
*   **后端服务**：
    *   **环境**：Node.js。
    *   **库**：Ethers.js (与区块链交互)、Express (提供 API 接口，可选，也可由前端直接连接合约)。
*   **前端界面**：
    *   **框架**：Vue.js (构建用户界面)。
    *   **组件库**：Element Plus 或类似 UI 库。
    *   **交互**：MetaMask (浏览器钱包插件，用于模拟用户签名和交易发送)。

## 4. 核心功能模块

### 4.1 智能合约模块
*   **数据结构**：严格遵循 MH/T 3010.7-2006 标准，定义复杂的 `struct` 存储检修详情。
*   **权限管理**：维护一个授权节点列表（Whitelist），只有授权地址才能调用写入函数。
*   **存证功能**：接收前端传入的 JSON 格式数据，解析并存储到链上。
*   **索引功能**：建立 `飞机号 -> 记录列表` 和 `工卡号 -> 记录详情` 的映射，优化查询效率。

### 4.2 前端交互模块
*   **身份登录**：
    *   访客模式：无需连接钱包，仅浏览。
    *   机械师模式：连接 MetaMask 钱包，识别地址权限。
*   **数据录入表单**：提供结构化的表单，对应 19 个核心字段，支持数据校验。
*   **查询界面**：提供搜索框，支持按机号或工卡号检索，以时间轴或列表形式展示结果。

## 5. 开发计划
1.  **环境搭建**：初始化 Hardhat 项目，配置本地网络。
2.  **合约开发**：编写 `AviationMaintenance.sol`，定义数据结构和核心逻辑。
3.  **合约测试**：编写单元测试脚本，确保存取逻辑无误。
4.  **后端/脚本开发**：编写部署脚本，以及（可选的）API 中间层。
5.  **前端开发**：搭建 Vue 框架，实现页面布局和与合约的交互。
6.  **联调与演示**：在本地启动 Hardhat 节点，模拟数据录入和查询流程。

## 6. 数据结构设计 (Solidity)
参考用户提供的 19 个字段，将在合约中定义如下结构：

*   **MaintenanceRecord**: 主结构体。
*   **PartToolList**: 嵌套结构体，存储航材/工具信息。
*   **TestMeasureData**: 嵌套结构体，存储测试数据。
*   **FaultInfo**: 嵌套结构体，存储故障信息。
*   **Signatures**: 嵌套结构体，存储各类人员签名信息。
*   **ReplaceInfo**: 嵌套结构体，存储拆换件信息。

---
*注：由于 Solidity 对结构体层级和局部变量数量有限制（"Stack too deep" 错误），在实际编码时可能需要将部分非关键的大文本字段（如详细描述、备注）存储为 IPFS 哈希或简化存储，或者利用事件（Event）来存储历史数据以节省 Gas。但在本项目（本地模拟）中，我们将尝试直接存储或适当拆分。*
